language: c
os:
  - linux
before_install:
  # runtime dependency
  - git clone https://github.com/jedisct1/libsodium
  - cd libsodium
  - ./autogen.sh
  - ./configure --prefix=/usr
  - make
  - sudo make install
  - cd ..
  #
  # unittest dependencies, perl modules
  - wget http://search.cpan.org/CPAN/authors/id/T/TL/TLINDEN/Config-General-2.56.tar.gz
  - tar xvzf Config-General-2.56.tar.gz
  - cd Config-General-2.56
  - perl Makefile.PL && make
  - sudo make install
  - cd ..
  - wget http://search.cpan.org/CPAN/authors/id/C/CH/CHORNY/Tie-IxHash-1.23.tar.gz
  - tar xvzf Tie-IxHash-1.23.tar.gz
  - cd Tie-IxHash-1.23
  - perl Makefile.PL && make
  - sudo make install
  - cd ..
  - wget http://search.cpan.org/CPAN/authors/id/I/IN/INGY/YAML-1.14.tar.gz
  - tar xvfz YAML-1.14.tar.gz
  - cd YAML-1.14
  - perl Makefile.PL && make
  - sudo make install
  - cd ..
  #
  # for debugging - just in case, uncomment this and the next if needed
  #- wget http://valgrind.org/downloads/valgrind-3.10.1.tar.bz2
  #- tar xvjf valgrind-3.10.1.tar.bz2
  #- cd valgrind-3.10.1
  #- ./configure --prefix=/usr
  #- make
  #- sudo make install
  #- cd ..
  #
  # valgrind runtime dependency
  #- sudo apt-get update
  #- sudo apt-get install libc6-dbg
  #
  # python bindings runtime dependencies
  - sudo apt-get update -qq
  - sudo apt-get install python-cffi 
  #- sudo pip install cffi
  #
  # finally prepare autoconf stuff
  - ./autogen.sh
compiler:
  - clang
  - gcc
script:
 - ./configure --enable-python-binding
 - make
 - make check
 - make test

