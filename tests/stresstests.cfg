#
# stress tests

confirm = Stress tests will take some time, continue?
pcp     = ../src/pcp1
outdir  = stresstest
vault   = $outdir/stresstestin
pvault  = $outdir/stresstestout
numkeys = 100
verbose = 1

<test check-bulk-tests>
  prepare = ./genmasskeys.sh $outdir $numkeys $pcp $vault

  <test check-bulk-generate-keys>
    cmd = $pcp -V $vault -l | grep 0x | wc -l
    expect = $numkeys
  </test>

  <test check-bulk-vault-export-publics>
    prepare = ./exportmasspubs.sh $outdir $pcp $vault
    cmd = ls -1 $outdir/0x* | wc -l
    expect = $numkeys
  </test>

  <test check-bulk-import-publics>
    prepare = ./importmasspubs.sh $outdir $pcp $pvault
    cmd = $pcp -V $pvault -l | grep 0x | wc -l
    expect $numkeys
  </test>
</test>
